// Description: Test bench file for Inference

#include <iostream>
#include <fstream>
#include <cmath>

#include "conv.h"
#include "utils.h"

using namespace std;

//--------------------------------------------------------------------------
// Input, Layers and Parameters, Output
//--------------------------------------------------------------------------
/*
#define IN_FM_DEPTH              1
#define IN_FM_HEIGHT            28            
#define IN_FM_WIDTH             28            

#define OUT_CONV_FM_DEPTH        1        
#define OUT_CONV_FM_HEIGHT      24       
#define OUT_CONV_FM_WIDTH       24       

#define OUT_MAX_POOL_FM_DEPTH    1        
#define OUT_MAX_POOL_FM_HEIGHT  12
#define OUT_MAX_POOL_FM_WIDTH   12       

#define IN_LINEAR_LENGTH       144 
#define OUT_LINEAR_LENGTH       10

#define POOL_DIM                 2 
#define STRIDE                   1
#define PADDING                  0  
#define KERNEL_HEIGHT            5
#define KERNEL_WIDTH             5
*/

fm_t input_feature_map[IN_FM_DEPTH][IN_FM_HEIGHT][IN_FM_WIDTH] = {0};
fm_t conv_layer_weights[IN_FM_DEPTH][OUT_CONV_FM_DEPTH][KERNEL_HEIGHT][KERNEL_WIDTH] = {0};
fm_t fc_params[IN_LINEAR_LENGTH][OUT_LINEAR_LENGTH] = {0};

fm_t pool_layer_output[OUT_MAX_POOL_FM_DEPTH][OUT_MAX_POOL_FM_HEIGHT][OUT_MAX_POOL_FM_WIDTH] = {0};
fm_t pool_layer_input[OUT_CONV_FM_DEPTH][OUT_CONV_FM_HEIGHT][OUT_CONV_FM_WIDTH] = {0};
fm_t fc_input[IN_LINEAR_LENGTH] = {0};
fm_t output_feature_map[OUT_LINEAR_LENGTH] = {0};

//--------------------------------------------------------------------
// Main function
//--------------------------------------------------------------------
int main ()
{
    long double mse = 0.0;

    // Read reference inputs, parameters, and output
    
    // Correct digit -> 7
    fm_t input_feature_map_linear[784] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,13,7,0,0,0,0,0,0,2,93,244,207,8,0,0,0,0,0,0,0,0,0,0,0,0,0,15,157,254,197,0,0,0,0,0,18,131,254,254,248,11,0,0,0,0,0,0,0,0,0,0,0,0,9,220,254,254,230,104,0,0,0,65,216,254,254,254,218,8,0,0,0,0,0,0,0,0,0,0,0,0,169,254,254,231,126,40,11,70,180,254,254,254,254,254,90,0,0,0,0,0,0,0,0,0,0,0,40,183,251,254,226,81,70,180,229,254,254,254,254,254,254,115,3,0,0,0,0,0,0,0,0,0,0,7,208,254,254,255,254,254,254,255,254,254,254,254,254,254,190,3,0,0,0,0,0,0,0,0,0,0,0,53,254,254,254,254,254,253,250,212,169,125,167,254,254,241,35,0,0,0,0,0,0,0,0,0,0,0,0,150,254,254,181,77,77,48,0,0,0,128,254,254,253,57,0,0,0,0,0,0,0,0,0,0,0,0,0,14,157,195,29,0,0,0,0,0,75,248,254,254,139,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,217,254,254,170,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,217,254,254,214,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,113,254,254,238,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,89,254,254,239,81,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,141,254,254,240,106,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,66,252,254,252,145,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,68,250,254,252,171,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,54,249,254,254,210,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,223,254,254,189,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,231,254,254,211,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,226,254,254,209,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    
    //Convert into 3-dimensional input feature map

    for(int loop1 = 0; loop1 < IN_FM_DEPTH; loop1++)
    {
        for(int loop2 = 0; loop2 < IN_FM_HEIGHT; loop2++)
        {
            for(int loop3 = 0; loop3 < IN_FM_WIDTH; loop3++)
            {
                input_feature_map[loop1][loop2][loop3] = input_feature_map_linear[loop1 * IN_FM_HEIGHT * IN_FM_WIDTH + loop2 * IN_FM_WIDTH + loop3];
            }
        }
    }

    //cout << input_feature_map << endl;
    
    wt_t conv_layer_weights[IN_FM_DEPTH][OUT_CONV_FM_DEPTH][KERNEL_HEIGHT][KERNEL_WIDTH] = {{{{-0.1648,  0.0501,  0.0750, -0.1781, -0.5307},{0.4710,  0.3274, -0.0759, -0.0607, -0.4544},{0.9363,  0.6784,  0.5588, -0.1320, -0.3528},{0.9443,  0.9656,  0.4373,  0.0831, -0.0475},{0.6369,  0.6583,  0.2988,  0.2740,  0.2249}}}};

    wt_t fc_params_linear[1440] = {-0.058371823,0.0013282103,-0.031196784,0.004219705,-0.02367116,0.0692328,-0.023035262,0.061094064,0.039923836,-0.057991855,-0.04316479,-0.011498283,0.020776605,0.006449525,0.056602318,0.024719808,-0.072727226,0.048873536,-0.042605113,0.04049066,0.008437963,0.020932766,-0.014596949,0.057626843,-0.0030747645,0.03238594,0.02136529,-0.00060584844,-0.065761134,0.020992158,-0.039877683,-0.073114924,0.08824592,0.056299932,-0.029659599,0.01399151,0.11981075,-0.06812414,-0.052673824,-0.02668988,-0.004825691,0.07982261,0.14266622,0.058596224,-0.034422304,-0.019126441,0.15012631,-0.17171869,-0.09250604,-0.018506037,-0.0046674707,0.108619265,0.12685888,0.027210748,-0.03723643,-0.0060341484,0.14042768,-0.09737426,0.038055845,-0.21850492,0.03175751,0.03997979,0.12862313,0.072223924,-0.06805049,-0.007069412,0.14595953,-0.043274794,0.083486155,-0.22833614,0.03567007,0.18743408,0.043234482,0.033350095,-0.0026441044,-0.04278369,0.1946973,-0.18898278,0.04783139,-0.21211968,0.02717877,0.14269967,0.11298355,0.014743568,0.039618384,0.034550395,0.2838244,-0.037844162,0.054714423,-0.17794754,-0.061746802,0.05172,0.056207836,-0.056012228,-0.0002503962,0.025125341,0.024019562,-0.05417183,-0.0012996461,-0.13061231,0.017761562,0.087682195,-0.07032321,-0.0337527,0.07124661,0.09880428,-0.04037713,0.05517124,0.019330218,0.015418132,-0.058612578,-0.08024806,0.0034690418,-0.002934815,0.013682502,0.0004688973,-0.063962884,-0.052182313,-0.02382842,-0.067492925,0.029988421,-0.07126724,0.1095964,0.0028972947,0.0117053045,-0.031079933,-0.015540243,-0.07278888,0.027965752,0.03608813,-0.057984307,-0.08942393,0.1576407,0.17698748,0.018888386,-0.04087309,-0.07933218,0.0023341824,-0.0241575,-0.09397148,-0.055497777,-0.06802287,0.05040739,0.08114057,0.081600636,0.07497256,-0.13762364,-0.07893747,-0.07483035,-0.11017002,-0.008219206,-0.12488893,0.039685033,0.089810416,0.04476211,0.036362648,0.040616304,-0.032575306,0.00013202753,-0.14161307,-0.015686149,-0.07809894,0.07914203,0.06558022,0.04654611,0.014914963,-0.00825631,-0.0067040212,-0.0039786776,-0.11524038,0.09696215,0.056741152,0.057941757,0.06655908,0.029299073,0.010660384,-0.016814109,0.007212119,0.10783197,0.08517252,0.11083711,-0.010608074,0.048315067,0.07379479,-0.035972923,0.04597109,0.027671102,0.009251521,0.11844374,0.16400796,0.10614885,0.06632655,0.08353978,0.06957457,-0.069861025,0.05591639,0.0033231461,-0.07813845,0.11100834,0.089993015,0.0726774,0.07803105,0.05119732,0.011837777,-0.035020653,0.06644247,0.013243505,-0.22021574,0.09144423,-0.07759588,-0.047608458,0.07516235,0.0075354804,-0.03881973,0.06379149,0.06574106,-0.09601451,-0.2346119,0.049933065,-0.1703003,-0.055862274,0.0516487,-0.07463475,-0.012500873,-0.0062826048,0.105641745,-0.032038845,-0.045104317,0.054430705,-0.18972217,0.03032746,0.019186359,-0.00771067,-0.101636745,0.090694584,0.02037552,0.0025259512,-0.05482222,0.051663186,-0.10817779,0.033349067,-0.084153205,0.09372799,0.13348831,-0.036793195,-0.08152627,-0.09179647,0.04893162,-0.01197184,-0.0818438,0.06991152,-0.04304457,0.053604845,0.10330586,0.09752303,-0.025454653,-0.053286597,0.054190326,0.023104383,-0.14347182,-0.03082421,-0.14623135,0.101337776,0.118349455,-0.026021313,0.10272015,-0.12500982,0.1001667,0.046666965,-0.04290935,-0.033629607,-0.1643804,0.02090511,0.06428262,-0.003451229,0.014937185,-0.024751658,0.06724536,-0.004701153,-0.03005591,-0.03692006,-0.081429414,0.071547024,-0.0009100886,-0.06758376,0.015279359,-0.069652654,0.07977649,0.013926955,0.056287084,0.06962643,0.07771274,0.059373192,0.042257402,-0.012184571,0.06269044,0.058295988,0.14669804,0.05990322,0.15172622,0.102293074,0.115055606,0.09751061,0.09567594,-0.041393127,0.0876523,0.049207423,0.19541472,0.053577106,0.20925161,0.1078104,0.04380132,0.07226353,0.07752808,-0.004699174,0.04262675,-0.11981387,0.11053531,0.038933404,0.12619624,0.10658389,0.023660332,0.0043104407,0.011365009,0.07314102,0.06578542,-0.22869232,0.051162932,-0.017202748,0.03378704,0.05633102,-0.017942583,0.004257176,0.07801127,0.010051726,0.12090509,-0.18012257,-0.051414277,0.047564343,-0.07582631,-0.021890817,-0.105859056,-0.07835038,-0.037545957,-0.043274254,0.26687253,-0.14571102,-0.050603766,0.07879897,-0.18958542,-0.033695165,-0.0340111,-0.037086956,-0.07838168,-0.0054239877,0.19479427,-0.10046744,-0.08122793,0.0065134214,-0.084615216,0.013599152,-0.07925037,-0.011284506,0.0399028,0.013690918,-0.013925078,-0.07799646,0.10104036,-0.032314662,-0.10131849,0.01942043,-0.05508741,0.074374475,-0.04711018,0.011945737,-0.054191995,-0.023280913,0.035718933,0.071141936,0.020845953,-0.029994687,-0.016643198,-0.0425657,-0.056159317,-0.049079668,0.026571026,0.04700238,0.08884846,0.08315128,0.04376767,-0.089264914,-0.11167818,-0.09617677,-0.1497732,-0.030664535,0.0013773696,0.0012950033,0.02534519,0.04435318,0.03438627,0.026914371,-0.022916261,-0.045984376,-0.1360791,-0.012711455,0.090091944,0.044201005,0.07187783,0.06383189,0.08142837,-0.0066159177,0.15161236,-0.09602567,0.0127125615,-0.066684134,0.0511084,0.019882824,0.08416447,0.003589187,0.08189238,0.01858363,0.15182872,0.023172187,0.1592684,0.02697124,-0.027390677,0.010248735,0.21103278,-0.010202671,0.022617374,0.018778048,0.01849534,-0.00076358084,0.09024253,0.059091493,-0.14910299,-0.24061078,0.18271491,-0.047200363,0.04489576,0.031965308,-0.10538175,0.00020872551,0.0039187525,0.0397445,-0.12736516,-0.22647782,0.15332104,0.00459901,0.07150792,0.013652282,-0.15509135,0.009589583,0.020179888,-0.043197345,-0.088800594,-0.122887544,-0.0017203001,0.06158579,-0.043253973,0.08343744,-0.16411068,-0.119920865,-0.0328889,-0.03451848,0.17774817,-0.14026135,-0.055523824,0.09182017,-0.10568331,0.026063923,0.03661197,-0.039536886,0.02640902,0.08053741,0.22227311,-0.09097702,-0.061218616,0.07877254,0.039829373,-0.046006326,-0.024475204,-0.09778343,0.028759751,0.027204102,0.029225506,-0.026954642,0.17558782,0.04245832,0.028579408,0.09644226,0.0020861423,-0.16100602,-0.15243402,-0.06967882,-0.08154721,0.001440489,0.04218239,0.035728388,0.068404905,-0.026144264,-0.036375612,-0.21558632,-0.20638844,-0.009697764,-0.010667794,0.023943331,0.048758365,-0.0013472289,0.07395488,0.0044529196,-0.17120509,-0.30582684,-0.1359557,0.016980678,0.026092356,0.03325818,-0.008937167,-0.040417347,0.006470694,0.043557152,-0.14276592,-0.34364462,-0.044273168,0.034150742,0.050539643,-0.01099729,-0.11141897,0.04943759,-0.008540585,0.025180101,0.1970544,-0.12362435,0.13054322,0.009019103,0.091565706,0.016692523,-0.058798578,0.11295862,-0.031549297,-0.2519972,0.13653046,0.009356556,0.08171034,0.04365086,-0.0136714475,-0.13276489,0.089061685,0.035965275,0.06052898,-0.13886788,-0.06583508,-0.06026764,0.036207013,0.03243683,-0.1444229,-0.13489845,0.08868686,-0.019870546,0.062082354,-0.017430356,-0.16972105,-0.03904325,-0.03485814,-0.004669837,-0.20637742,-0.0017974669,0.07480556,0.015047459,0.13940448,0.03485413,-0.17052422,-0.029428478,-0.03281059,-0.045728542,-0.30976754,0.0891512,0.0013878451,0.059235264,0.030778999,0.13051063,-0.080737926,-0.15681762,-0.028622223,0.06059619,-0.08625062,0.07621852,-0.07484231,0.11384127,-0.097975515,0.038562693,0.05286298,-0.09862306,-0.00896725,-0.046361145,0.040735077,-0.020906188,-0.04118395,-0.04115115,-0.013199347,-0.06505258,-0.015372546,-0.0971094,-0.036675934,0.012511992,-0.074777484,-0.096137345,0.055311017,-0.033465352,-0.023083745,0.039794113,0.06924369,-0.14229661,-0.17655542,0.11211834,-0.12412946,-0.032543864,-0.12940714,-0.07627373,0.029459966,-0.015136688,-0.08228502,-0.13145679,-0.15467855,0.0469086,-0.11811705,0.016556146,-0.06049217,-0.2424774,-0.02830829,0.077208266,-0.32257485,-0.06753026,-0.017792733,0.079329,0.011481412,0.06417009,-0.2400814,-0.11222648,0.030858207,0.090443164,-0.079786755,-0.046775185,0.11986619,0.062492624,0.11847584,0.06725324,-0.35646713,0.022459952,0.005304434,-0.1956191,0.18437508,0.03028529,0.13763891,-0.008629145,0.06605152,0.10011954,-0.1327911,0.10955009,0.042062253,-0.3968025,0.06276289,-0.01742074,0.029826766,-0.012979996,-0.034394402,0.019726893,0.006673064,0.016792567,0.079685956,-0.11282209,-0.22767353,-0.06692242,-0.017303659,0.104017235,-0.048666585,-0.017230326,-0.0021296842,-0.058237825,0.07073134,0.022288358,-0.1754019,-0.06962042,-0.04633874,0.10182679,0.0039567556,0.047592368,0.018032024,-0.13285357,0.07008987,0.008508693,-0.12574367,-0.070131265,0.013614406,0.067001715,-0.101280145,0.13866386,0.044618867,-0.09509975,-0.15250386,0.11040524,0.0029683327,-0.14173837,0.021098323,0.02894429,-0.14315768,0.07520275,0.015930826,-0.02621725,-0.08032271,0.032701347,-0.05724309,-0.07573539,-0.05906503,-0.039853815,-0.010021828,0.0929758,-0.0007805164,0.02021295,-0.06294563,0.0045493795,-0.08229344,0.0006968121,-0.011069092,-0.02934816,0.03313483,-0.080034755,-0.07002824,0.03748817,-0.048048865,0.008494153,-0.09342757,-0.073964834,-0.039121233,0.1019871,-0.09110434,-0.09545532,-0.070436835,-0.1268784,-0.075581156,-0.002278197,-0.17326438,-0.022690488,-0.11393671,0.053674452,-0.1698338,-0.023379648,-0.10419902,-0.26649156,-0.12000787,0.034419313,-0.2635619,0.0070889066,-0.11069528,0.015830517,-0.06891268,0.090447664,-0.15107153,-0.042691648,-0.005314959,-0.06756718,0.049053952,0.055819567,-0.015874049,0.047647573,-0.025714891,0.065796785,-0.16432059,0.03898033,-0.00045806877,-0.36548004,0.1832652,0.09954611,-0.01823165,0.09018853,-0.060476467,0.092134744,-0.0038234773,0.055089463,0.012149132,-0.24480526,0.014100368,-0.07248103,-0.09798524,-0.0056252615,-0.0885947,-0.018557979,0.0063565066,-0.02809825,0.009222301,-0.049396336,-0.40271252,-0.082855836,0.019289868,0.09140678,-0.0670494,-0.075332545,0.024173312,-0.1105485,0.03562235,0.052323215,-0.19072762,0.032155626,0.0062829857,0.01943173,0.04549415,0.058475263,0.048487443,-0.18705027,-0.22796936,0.07261883,-0.0436815,-0.051864777,-0.0057343408,-0.0366977,0.07153097,0.062982835,-0.05531175,-0.077429324,-0.16164382,0.07997895,-0.0003835664,0.057946943,0.098211065,0.073525414,-0.036944073,-0.022629492,-0.09984763,-0.0098404195,-0.0031021112,0.053287048,-0.025343316,0.15102454,0.0064770505,-0.056402948,0.037874546,0.05138941,0.0052009653,-0.03109883,0.058241956,0.05230286,-0.03035382,0.13346156,0.14558776,-0.021421121,-0.038808595,-0.050428543,-0.0050995243,-0.11243616,0.06975866,0.08481828,-0.04123495,0.15302972,0.05013301,-0.07457092,0.11457076,-0.045225874,-0.11729893,-0.117852405,-0.13355964,0.14982979,-0.22177906,0.044161685,-0.088924706,0.059672434,0.049447946,0.055576686,-0.062213354,0.027601704,-0.12565614,0.15274985,-0.0100197885,0.04944988,-0.18313178,-0.04362532,-0.052868962,0.18342564,-0.011843452,0.15725325,0.017810604,-0.054672446,0.10933587,0.13800307,-0.21583663,-0.020656565,-0.14998423,0.144183,0.022057815,0.10889982,0.010950655,-0.15593818,0.17739703,0.12325312,-0.24683812,0.054518104,-0.11961342,0.06407856,0.07301935,-0.033069313,-0.005404672,-0.058581635,-0.053599346,0.008337039,-0.07471356,0.08742706,-0.02638812,-0.010304959,0.018892184,-0.04559192,0.01567829,-0.0062222835,-0.1976974,0.037145328,-0.005554697,0.0957032,0.032133885,-0.06677905,-0.023109935,-0.05505931,-0.0052897152,0.010015692,-0.052858055,0.107590415,0.004930681,-0.04047057,0.033787888,0.029936569,0.0013916508,-0.04003461,-0.18392496,0.029858455,-0.0060566613,0.13226087,0.03052838,-0.027336264,0.08451799,0.0069376524,-0.14021787,-0.0044801785,-0.082438596,0.018065957,0.03551223,0.1898809,0.093310356,-0.0017478062,0.0136313485,0.02027241,-0.17837904,0.022704855,-0.09270591,0.04206018,0.067161195,0.1889232,-0.017173836,0.05713749,0.013873166,-0.11081736,-0.013541525,-0.065628886,-0.061364777,-0.01834738,0.016823472,0.10605626,0.17071226,-0.043278225,-0.018518645,-0.066455774,-0.06583893,-0.0723094,-0.047193486,0.0780361,-0.08814814,0.15215908,0.18067934,-0.0141249485,0.14442721,-0.15019993,-0.092820264,0.009625522,-0.01283808,0.14333977,-0.02965048,0.10955567,0.06418217,0.028605057,0.19671327,0.06049889,-0.05365713,0.102544636,-0.1158313,0.16317867,0.08631529,0.081988364,-0.05596852,-0.02687745,0.14624675,0.20712566,-0.041013964,0.14174458,-0.085550204,0.0817783,0.10578995,0.13843744,-0.07045282,-0.023220865,0.017530793,0.17336176,0.061241478,0.03444262,-0.06563621,-0.02203289,0.10125914,0.061858177,-0.056452144,-0.015177314,0.016219359,0.040997982,-0.026760926,-0.06578835,-0.05315898,-0.012950609,-0.033041578,0.033785,0.022729248,-0.012034941,0.033554982,-0.0061857337,-0.04513546,-0.09192497,-0.060957342,0.025640553,-0.058282796,0.056942854,0.09600095,-0.012013628,0.066378064,0.033307746,-0.15055312,-0.01875579,-0.038195003,-0.021801263,0.015329043,0.044096854,0.04974119,-0.020443015,0.034216624,0.050500154,-0.06971794,-0.023369903,-0.098860875,-0.05500518,-0.09033389,0.10202779,0.060454812,0.06502185,0.07002016,0.038173582,-0.14045767,0.014534159,0.006374187,-0.005688357,-0.05355902,0.18561615,0.058235247,-0.032625515,-0.054029938,-0.042824488,-0.12783763,0.015559688,-0.08004561,-0.024851678,0.06181293,0.031547405,0.0018446663,-0.07360288,-0.0058575366,-0.056698132,0.0099227475,0.06154194,-0.043833945,0.0053015742,-0.024797851,0.14200646,0.23174249,0.07150613,-0.052749682,0.022039797,0.021481486,-0.019093795,0.045445085,0.15029903,0.029958215,0.14417166,0.17164408,-0.056584246,0.04806482,-0.18354006,-0.03008795,0.06156495,-0.084010825,0.08276156,0.13299888,0.047700472,0.06637772,0.017389722,0.049944054,-0.023882573,-0.0073757065,0.087500975,0.000828718,0.12372805,0.109657824,0.083081335,0.07741296,-0.037513603,0.06597714,0.083218925,0.049804516,0.09808834,-0.047665946,0.10462099,0.032271553,0.10178728,0.046066836,-0.040117983,0.12027135,0.06635425,0.036601644,0.014257216,-0.015895966,0.04411955,-0.017087659,-0.033293407,0.066063754,0.02497412,0.044499233,0.009098633,-0.044712134,0.03142498,-0.047417697,-0.011621297,0.03919155,-0.039953463,0.0628625,-0.034025334,0.033192463,-0.05425785,-0.07904185,0.012214516,-0.07078432,0.020028008,0.0032201533,-0.021567456,0.07953937,-0.0075595323,0.065289415,-0.016172562,-0.067001484,-0.009714517,-0.031563904,-0.07058159,-0.07103084,0.00032690083,0.03920194,-0.018604616,0.013361384,-0.013739295,-0.112878144,0.05672514,0.0014324306,0.03462107,-0.117067516,-0.0247361,-0.042720687,0.024605626,0.0009932284,-0.003488219,-0.14713132,-0.0394939,0.026461229,0.09203205,-0.09369431,0.069089204,-0.06321062,-0.059806,0.06568726,0.017928451,-0.032255672,0.03944027,0.043803718,0.0045726276,-0.017342376,0.01873647,-0.053275313,0.053500697,-0.042424437,0.011250308,0.071129546,-0.0018040842,-0.026634892,0.07057755,0.027435292,0.0043271696,0.12249861,-0.055868037,0.0064965673,-0.01846214,0.0067883045,-0.10482724,0.027209777,0.06887368,0.05341442,0.028285757,0.2059619,-0.06704849,-0.06426034,-0.06999615,0.09700829,-0.11856088,-0.012491517,0.013300801,0.08797409,0.00525146,0.13699996,-0.076234385,0.0031047713,-0.14598957,0.11111164,-0.00055952976,0.057533342,0.043874502,-0.06550114,-0.028974995,0.089235604,0.03317452,0.01899735,-0.103196956,0.07556694,0.045148432,0.019838728,0.09410673,-0.11193057,-0.049868487,0.068114355,-0.048847,0.046257306,-0.24358778,0.09342761,0.13396147,0.0043527894,0.10843881,-0.025942666,-0.14119959,0.018587,0.020494854,0.0517714,-0.26475698,0.09589105,0.14276405,0.00990621,0.036514614,0.08710667,-0.0640734,0.02305475,-0.011234153,0.07385748,-0.13493904,0.098944426,0.11156986,-0.03070791,-0.04973486,0.048952628,-0.05449928,-0.11560287,-0.0047137584,0.051615477,-0.08780979,-0.031061484,0.11709873,-0.016922897,0.06487655,-0.014223633,0.015051715,-0.006911309,0.052619174,-0.07916442,-0.07293861,-0.16885693,0.054875,0.10475301,-0.028718006,-0.088032626,0.056032293,0.038386535,0.07355117,0.024708252,0.029598277,-0.011214116,-0.1045624,0.08808116,-0.041374475,-0.058136698,0.06426753,0.023165496,0.03294743,0.004636585,0.033323627,0.0068855123,-0.024648145,0.09920049,-0.076528996,0.010366258,-0.03287183,-0.00043293947,0.018758554,0.07523673,0.06823,-0.06848234,-0.009093779,-0.008158953,-0.08685406,-0.07350549,0.026050733,0.1117613,-0.0012485362,0.041583728,0.0027635305,0.06228276,-0.10440825,0.057844687,-0.003562148,0.009876343,-0.058683835,0.085433245,-0.07234652,-0.07331589,-0.0131016215,0.034503184,-0.12647343,0.10143114,-0.09164599,-0.06347921,-0.04975801,0.13921428,-0.025407825,-0.048989348,-0.11384183,0.1969979,-0.07744128,0.04024884,0.0026870756,-0.027194006,-0.10407329,0.086489595,0.008478123,-0.053165257,0.0067967474,0.17205715,0.0027671237,0.09373043,-0.050212134,-0.11965871,-0.05836565,0.103856705,0.018671267,-0.059454065,-0.09115055,0.22424808,-0.08020175,0.15802176,-0.005194189,-0.11107901,-0.019299753,0.094271235,0.015022028,0.00800496,-0.10290653,0.1926984,-0.001922662,0.146286,-0.073135205,0.047790963,0.037756965,-0.0014719462,0.018905988,-0.028091757,-0.036903363,0.17668182,0.09089604,0.1774536,-0.06884189,0.029958006,-0.064862214,-0.06959225,-0.049137115,0.03748292,0.035133097,0.007267598,0.021310244,0.13750185,0.06546149,0.05290484,0.015135777,0.058580533,0.07471622,-0.04470292,-0.028321395,-0.038671907,0.008060771,0.07881504,-0.034834884,-0.042974435,0.031324312,0.054080814,-0.02252532,-0.08051705,0.035091788,0.0437603,0.00899731,0.084656,0.06278844,0.040659443,0.02156695,-0.0015896311,-0.07598409,0.014143541,-0.047694094,-0.002814497,0.03750069,-0.037430603,0.07756753,-0.07192865,0.022002347,-0.008684126,-0.047002964,0.028555365,0.034197383,0.022074752,-0.071206555,-0.08284362};

    //Convert into 2-dimensional fc_params 
    
    for(int loop1 = 0; loop1 < IN_LINEAR_LENGTH; loop1++)
    {
        for(int loop2 = 0; loop2 < OUT_LINEAR_LENGTH; loop2++)
        {
            fc_params[loop1][loop2] = fc_params_linear[loop1 * OUT_LINEAR_LENGTH + loop2];
        }
    }

    std::cout << "Beginning Inference..." << std::endl;
    
    // Call kernel function here
    tiled_conv(input_feature_map, conv_layer_weights, fc_params, output_feature_map);

    std::cout << " Inference completed! " << std::endl;

    system("pause");

    return 0;
}