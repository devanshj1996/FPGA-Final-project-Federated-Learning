// Description: Test bench file for Inference

#include <iostream>
#include <fstream>
#include <cmath>

#include "conv.h"
#include "utils.h"

using namespace std;

//--------------------------------------------------------------------------
// Input, Layers and Parameters, Output
//--------------------------------------------------------------------------

fm_t input_feature_map[IN_FM_DEPTH][IN_FM_HEIGHT][IN_FM_WIDTH] = {0};
fm_t conv_layer_weights[IN_FM_DEPTH][OUT_CONV_FM_DEPTH][KERNEL_HEIGHT][KERNEL_WIDTH] = {0};
fm_t fc_params[IN_LINEAR_LENGTH][OUT_LINEAR_LENGTH] = {0};

fm_t pool_layer_output[OUT_MAX_POOL_FM_DEPTH][OUT_MAX_POOL_FM_HEIGHT][OUT_MAX_POOL_FM_WIDTH] = {0};
fm_t pool_layer_input[OUT_CONV_FM_DEPTH][OUT_CONV_FM_HEIGHT][OUT_CONV_FM_WIDTH] = {0};
fm_t fc_input[IN_LINEAR_LENGTH] = {0};
fm_t output_feature_map[OUT_LINEAR_LENGTH] = {0};
fm_t mse[1] = {0};

//--------------------------------------------------------------------
// Main function
//--------------------------------------------------------------------
int main ()
{
    //long double mse = 0.0;

    // Read reference inputs, parameters, and output
    
    // Correct digit -> 7
    fm_t target_output_set[SET_SIZE][10] = {{0,0,0,0,0,0,0,1,0,0}, {1,0,0,0,0,0,0,0,0,0}};//, {0,1,0,0,0,0,0,0,0,0}};
    fm_t input_feature_set_linear[SET_SIZE][784] = {{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,13,7,0,0,0,0,0,0,2,93,244,207,8,0,0,0,0,0,0,0,0,0,0,0,0,0,15,157,254,197,0,0,0,0,0,18,131,254,254,248,11,0,0,0,0,0,0,0,0,0,0,0,0,9,220,254,254,230,104,0,0,0,65,216,254,254,254,218,8,0,0,0,0,0,0,0,0,0,0,0,0,169,254,254,231,126,40,11,70,180,254,254,254,254,254,90,0,0,0,0,0,0,0,0,0,0,0,40,183,251,254,226,81,70,180,229,254,254,254,254,254,254,115,3,0,0,0,0,0,0,0,0,0,0,7,208,254,254,255,254,254,254,255,254,254,254,254,254,254,190,3,0,0,0,0,0,0,0,0,0,0,0,53,254,254,254,254,254,253,250,212,169,125,167,254,254,241,35,0,0,0,0,0,0,0,0,0,0,0,0,150,254,254,181,77,77,48,0,0,0,128,254,254,253,57,0,0,0,0,0,0,0,0,0,0,0,0,0,14,157,195,29,0,0,0,0,0,75,248,254,254,139,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,217,254,254,170,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,217,254,254,214,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,113,254,254,238,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,89,254,254,239,81,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,141,254,254,240,106,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,66,252,254,252,145,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,68,250,254,252,171,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,54,249,254,254,210,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,223,254,254,189,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,231,254,254,211,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,226,254,254,209,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}, {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,146,254,255,251,95,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,97,234,254,254,232,254,254,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,89,140,254,254,174,67,33,200,254,190,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,108,253,254,235,51,1,0,0,12,254,253,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,216,254,244,55,0,0,0,0,6,213,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,254,254,132,0,0,0,0,0,0,168,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,254,243,34,0,0,0,0,0,0,168,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,254,157,0,0,0,0,0,0,0,168,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,228,254,105,0,0,0,0,0,0,7,228,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,58,254,254,87,0,0,0,0,0,0,10,254,246,47,0,0,0,0,0,0,0,0,0,0,0,0,0,0,58,254,254,9,0,0,0,0,0,0,10,254,210,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,58,254,254,9,0,0,0,0,0,0,105,254,91,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,219,254,9,0,0,0,0,0,24,230,254,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,216,254,9,0,0,0,0,0,84,254,251,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,216,254,36,0,0,0,0,22,208,251,94,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,254,120,0,0,0,3,140,254,229,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,83,254,222,17,0,0,91,254,236,53,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,235,254,134,21,119,237,254,124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,53,249,254,234,252,254,172,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,116,237,254,254,133,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};//,
     //{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,13,7,0,0,0,0,0,0,2,93,244,207,8,0,0,0,0,0,0,0,0,0,0,0,0,0,15,157,254,197,0,0,0,0,0,18,131,254,254,248,11,0,0,0,0,0,0,0,0,0,0,0,0,9,220,254,254,230,104,0,0,0,65,216,254,254,254,218,8,0,0,0,0,0,0,0,0,0,0,0,0,169,254,254,231,126,40,11,70,180,254,254,254,254,254,90,0,0,0,0,0,0,0,0,0,0,0,40,183,251,254,226,81,70,180,229,254,254,254,254,254,254,115,3,0,0,0,0,0,0,0,0,0,0,7,208,254,254,255,254,254,254,255,254,254,254,254,254,254,190,3,0,0,0,0,0,0,0,0,0,0,0,53,254,254,254,254,254,253,250,212,169,125,167,254,254,241,35,0,0,0,0,0,0,0,0,0,0,0,0,150,254,254,181,77,77,48,0,0,0,128,254,254,253,57,0,0,0,0,0,0,0,0,0,0,0,0,0,14,157,195,29,0,0,0,0,0,75,248,254,254,139,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,217,254,254,170,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,217,254,254,214,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,113,254,254,238,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,89,254,254,239,81,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,141,254,254,240,106,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,66,252,254,252,145,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,68,250,254,252,171,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,54,249,254,254,210,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,223,254,254,189,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,231,254,254,211,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,226,254,254,209,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};
    //fm_t input_feature_map_linear[784] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,13,7,0,0,0,0,0,0,2,93,244,207,8,0,0,0,0,0,0,0,0,0,0,0,0,0,15,157,254,197,0,0,0,0,0,18,131,254,254,248,11,0,0,0,0,0,0,0,0,0,0,0,0,9,220,254,254,230,104,0,0,0,65,216,254,254,254,218,8,0,0,0,0,0,0,0,0,0,0,0,0,169,254,254,231,126,40,11,70,180,254,254,254,254,254,90,0,0,0,0,0,0,0,0,0,0,0,40,183,251,254,226,81,70,180,229,254,254,254,254,254,254,115,3,0,0,0,0,0,0,0,0,0,0,7,208,254,254,255,254,254,254,255,254,254,254,254,254,254,190,3,0,0,0,0,0,0,0,0,0,0,0,53,254,254,254,254,254,253,250,212,169,125,167,254,254,241,35,0,0,0,0,0,0,0,0,0,0,0,0,150,254,254,181,77,77,48,0,0,0,128,254,254,253,57,0,0,0,0,0,0,0,0,0,0,0,0,0,14,157,195,29,0,0,0,0,0,75,248,254,254,139,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,217,254,254,170,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,217,254,254,214,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,113,254,254,238,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,89,254,254,239,81,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,141,254,254,240,106,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,66,252,254,252,145,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,68,250,254,252,171,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,54,249,254,254,210,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,223,254,254,189,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,231,254,254,211,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,226,254,254,209,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    //fm_t target_output[OUT_LINEAR_LENGTH] = {0,0,0,0,0,0,0,1,0,0};


    //fm_t input_feature_map_linear[784] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,146,254,255,251,95,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,97,234,254,254,232,254,254,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,89,140,254,254,174,67,33,200,254,190,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,108,253,254,235,51,1,0,0,12,254,253,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,216,254,244,55,0,0,0,0,6,213,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,254,254,132,0,0,0,0,0,0,168,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,254,243,34,0,0,0,0,0,0,168,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,254,157,0,0,0,0,0,0,0,168,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,228,254,105,0,0,0,0,0,0,7,228,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,58,254,254,87,0,0,0,0,0,0,10,254,246,47,0,0,0,0,0,0,0,0,0,0,0,0,0,0,58,254,254,9,0,0,0,0,0,0,10,254,210,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,58,254,254,9,0,0,0,0,0,0,105,254,91,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,219,254,9,0,0,0,0,0,24,230,254,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,216,254,9,0,0,0,0,0,84,254,251,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,216,254,36,0,0,0,0,22,208,251,94,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,254,120,0,0,0,3,140,254,229,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,83,254,222,17,0,0,91,254,236,53,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,235,254,134,21,119,237,254,124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,53,249,254,234,252,254,172,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,116,237,254,254,133,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };


    //fm_t input_feature_map_linear[784] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,13,7,0,0,0,0,0,0,2,93,244,207,8,0,0,0,0,0,0,0,0,0,0,0,0,0,15,157,254,197,0,0,0,0,0,18,131,254,254,248,11,0,0,0,0,0,0,0,0,0,0,0,0,9,220,254,254,230,104,0,0,0,65,216,254,254,254,218,8,0,0,0,0,0,0,0,0,0,0,0,0,169,254,254,231,126,40,11,70,180,254,254,254,254,254,90,0,0,0,0,0,0,0,0,0,0,0,40,183,251,254,226,81,70,180,229,254,254,254,254,254,254,115,3,0,0,0,0,0,0,0,0,0,0,7,208,254,254,255,254,254,254,255,254,254,254,254,254,254,190,3,0,0,0,0,0,0,0,0,0,0,0,53,254,254,254,254,254,253,250,212,169,125,167,254,254,241,35,0,0,0,0,0,0,0,0,0,0,0,0,150,254,254,181,77,77,48,0,0,0,128,254,254,253,57,0,0,0,0,0,0,0,0,0,0,0,0,0,14,157,195,29,0,0,0,0,0,75,248,254,254,139,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,217,254,254,170,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,217,254,254,214,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,113,254,254,238,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,89,254,254,239,81,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,141,254,254,240,106,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,66,252,254,252,145,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,68,250,254,252,171,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,54,249,254,254,210,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,223,254,254,189,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,231,254,254,211,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,226,254,254,209,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };


    //fm_t input_feature_map_linear[784] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,189,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,91,254,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,255,87,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,77,254,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,155,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,183,249,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,150,252,47,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,150,254,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,150,254,82,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,225,249,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };


    //fm_t input_feature_map_linear[784] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,18,18,18,126,136,175,26,166,255,247,127,0,0,0,0,0,0,0,0,0,0,0,0,30,36,94,154,170,253,253,253,253,253,225,172,253,242,195,64,0,0,0,0,0,0,0,0,0,0,0,49,238,253,253,253,253,253,253,253,253,251,93,82,82,56,39,0,0,0,0,0,0,0,0,0,0,0,0,18,219,253,253,253,253,253,198,182,247,241,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,156,107,253,253,205,11,0,43,154,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,1,154,253,90,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,139,253,190,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,190,253,70,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,35,241,225,160,108,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,81,240,253,253,119,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,186,253,253,150,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,93,252,253,187,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,249,253,249,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,46,130,183,253,253,207,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39,148,229,253,253,253,250,182,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,114,221,253,253,253,253,201,78,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23,66,213,253,253,253,253,198,81,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,171,219,253,253,253,253,195,80,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,172,226,253,253,253,253,244,133,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,136,253,253,253,212,135,132,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};


    //fm_t input_feature_map_linear[784] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,51,159,253,159,50,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,48,238,252,252,252,237,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,54,227,253,252,239,233,252,57,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,60,224,252,253,252,202,84,252,253,122,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,163,252,252,252,253,252,252,96,189,253,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,51,238,253,253,190,114,253,228,47,79,255,168,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,48,238,252,252,179,12,75,121,21,0,0,253,243,50,0,0,0,0,0,0,0,0,0,0,0,0,0,38,165,253,233,208,84,0,0,0,0,0,0,253,252,165,0,0,0,0,0,0,0,0,0,0,0,0,7,178,252,240,71,19,28,0,0,0,0,0,0,253,252,195,0,0,0,0,0,0,0,0,0,0,0,0,57,252,252,63,0,0,0,0,0,0,0,0,0,253,252,195,0,0,0,0,0,0,0,0,0,0,0,0,198,253,190,0,0,0,0,0,0,0,0,0,0,255,253,196,0,0,0,0,0,0,0,0,0,0,0,76,246,252,112,0,0,0,0,0,0,0,0,0,0,253,252,148,0,0,0,0,0,0,0,0,0,0,0,85,252,230,25,0,0,0,0,0,0,0,0,7,135,253,186,12,0,0,0,0,0,0,0,0,0,0,0,85,252,223,0,0,0,0,0,0,0,0,7,131,252,225,71,0,0,0,0,0,0,0,0,0,0,0,0,85,252,145,0,0,0,0,0,0,0,48,165,252,173,0,0,0,0,0,0,0,0,0,0,0,0,0,0,86,253,225,0,0,0,0,0,0,114,238,253,162,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,252,249,146,48,29,85,178,225,253,223,167,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,252,252,252,229,215,252,252,252,196,130,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28,199,252,252,253,252,252,233,145,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,128,252,253,252,141,37,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    //fm_t input_feature_map_linear[784] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,67,232,39,0,0,0,0,0,0,0,0,0,62,81,0,0,0,0,0,0,0,0,0,0,0,0,0,0,120,180,39,0,0,0,0,0,0,0,0,0,126,163,0,0,0,0,0,0,0,0,0,0,0,0,0,2,153,210,40,0,0,0,0,0,0,0,0,0,220,163,0,0,0,0,0,0,0,0,0,0,0,0,0,27,254,162,0,0,0,0,0,0,0,0,0,0,222,163,0,0,0,0,0,0,0,0,0,0,0,0,0,183,254,125,0,0,0,0,0,0,0,0,0,46,245,163,0,0,0,0,0,0,0,0,0,0,0,0,0,198,254,56,0,0,0,0,0,0,0,0,0,120,254,163,0,0,0,0,0,0,0,0,0,0,0,0,23,231,254,29,0,0,0,0,0,0,0,0,0,159,254,120,0,0,0,0,0,0,0,0,0,0,0,0,163,254,216,16,0,0,0,0,0,0,0,0,0,159,254,67,0,0,0,0,0,0,0,0,0,14,86,178,248,254,91,0,0,0,0,0,0,0,0,0,0,159,254,85,0,0,0,47,49,116,144,150,241,243,234,179,241,252,40,0,0,0,0,0,0,0,0,0,0,150,253,237,207,207,207,253,254,250,240,198,143,91,28,5,233,250,0,0,0,0,0,0,0,0,0,0,0,0,119,177,177,177,177,177,98,56,0,0,0,0,0,102,254,220,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,169,254,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,169,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,169,254,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,169,255,94,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,169,254,96,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,169,254,153,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,169,255,153,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,254,153,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    
    //Convert into 3-dimensional input feature map

    /*for(int loop1 = 0; loop1 < IN_FM_DEPTH; loop1++)
    {
        for(int loop2 = 0; loop2 < IN_FM_HEIGHT; loop2++)
        {
            for(int loop3 = 0; loop3 < IN_FM_WIDTH; loop3++)
            {
                input_feature_map[loop1][loop2][loop3] = input_feature_map_linear[loop1 * IN_FM_HEIGHT * IN_FM_WIDTH + loop2 * IN_FM_WIDTH + loop3];
            }
        }
    }*/

    //cout << input_feature_map << endl;
    
    //wt_t conv_layer_weights[IN_FM_DEPTH][OUT_CONV_FM_DEPTH][KERNEL_HEIGHT][KERNEL_WIDTH] = {{{{-0.1648,  0.0501,  0.0750, -0.1781, -0.5307},{0.4710,  0.3274, -0.0759, -0.0607, -0.4544},{0.9363,  0.6784,  0.5588, -0.1320, -0.3528},{0.9443,  0.9656,  0.4373,  0.0831, -0.0475},{0.6369,  0.6583,  0.2988,  0.2740,  0.2249}}}};
    wt_t conv_layer_weights[IN_FM_DEPTH][OUT_CONV_FM_DEPTH][KERNEL_HEIGHT][KERNEL_WIDTH] = { {{{-0.0801, -0.1498,  0.1818,  0.2058, -0.0423},{-0.1670,  0.3049,  0.5410,  0.2155,  0.3863},{0.1328,  0.5504,  0.8918,  0.6554,  0.3264},{0.4062,  0.8718,  1.1696,  1.0350,  0.3345},{0.2787,  0.5149,  0.5678,  0.7517,  0.2824}}}};

    //wt_t fc_params_linear[1440] = {-0.058371823,0.0013282103,-0.031196784,0.004219705,-0.02367116,0.0692328,-0.023035262,0.061094064,0.039923836,-0.057991855,-0.04316479,-0.011498283,0.020776605,0.006449525,0.056602318,0.024719808,-0.072727226,0.048873536,-0.042605113,0.04049066,0.008437963,0.020932766,-0.014596949,0.057626843,-0.0030747645,0.03238594,0.02136529,-0.00060584844,-0.065761134,0.020992158,-0.039877683,-0.073114924,0.08824592,0.056299932,-0.029659599,0.01399151,0.11981075,-0.06812414,-0.052673824,-0.02668988,-0.004825691,0.07982261,0.14266622,0.058596224,-0.034422304,-0.019126441,0.15012631,-0.17171869,-0.09250604,-0.018506037,-0.0046674707,0.108619265,0.12685888,0.027210748,-0.03723643,-0.0060341484,0.14042768,-0.09737426,0.038055845,-0.21850492,0.03175751,0.03997979,0.12862313,0.072223924,-0.06805049,-0.007069412,0.14595953,-0.043274794,0.083486155,-0.22833614,0.03567007,0.18743408,0.043234482,0.033350095,-0.0026441044,-0.04278369,0.1946973,-0.18898278,0.04783139,-0.21211968,0.02717877,0.14269967,0.11298355,0.014743568,0.039618384,0.034550395,0.2838244,-0.037844162,0.054714423,-0.17794754,-0.061746802,0.05172,0.056207836,-0.056012228,-0.0002503962,0.025125341,0.024019562,-0.05417183,-0.0012996461,-0.13061231,0.017761562,0.087682195,-0.07032321,-0.0337527,0.07124661,0.09880428,-0.04037713,0.05517124,0.019330218,0.015418132,-0.058612578,-0.08024806,0.0034690418,-0.002934815,0.013682502,0.0004688973,-0.063962884,-0.052182313,-0.02382842,-0.067492925,0.029988421,-0.07126724,0.1095964,0.0028972947,0.0117053045,-0.031079933,-0.015540243,-0.07278888,0.027965752,0.03608813,-0.057984307,-0.08942393,0.1576407,0.17698748,0.018888386,-0.04087309,-0.07933218,0.0023341824,-0.0241575,-0.09397148,-0.055497777,-0.06802287,0.05040739,0.08114057,0.081600636,0.07497256,-0.13762364,-0.07893747,-0.07483035,-0.11017002,-0.008219206,-0.12488893,0.039685033,0.089810416,0.04476211,0.036362648,0.040616304,-0.032575306,0.00013202753,-0.14161307,-0.015686149,-0.07809894,0.07914203,0.06558022,0.04654611,0.014914963,-0.00825631,-0.0067040212,-0.0039786776,-0.11524038,0.09696215,0.056741152,0.057941757,0.06655908,0.029299073,0.010660384,-0.016814109,0.007212119,0.10783197,0.08517252,0.11083711,-0.010608074,0.048315067,0.07379479,-0.035972923,0.04597109,0.027671102,0.009251521,0.11844374,0.16400796,0.10614885,0.06632655,0.08353978,0.06957457,-0.069861025,0.05591639,0.0033231461,-0.07813845,0.11100834,0.089993015,0.0726774,0.07803105,0.05119732,0.011837777,-0.035020653,0.06644247,0.013243505,-0.22021574,0.09144423,-0.07759588,-0.047608458,0.07516235,0.0075354804,-0.03881973,0.06379149,0.06574106,-0.09601451,-0.2346119,0.049933065,-0.1703003,-0.055862274,0.0516487,-0.07463475,-0.012500873,-0.0062826048,0.105641745,-0.032038845,-0.045104317,0.054430705,-0.18972217,0.03032746,0.019186359,-0.00771067,-0.101636745,0.090694584,0.02037552,0.0025259512,-0.05482222,0.051663186,-0.10817779,0.033349067,-0.084153205,0.09372799,0.13348831,-0.036793195,-0.08152627,-0.09179647,0.04893162,-0.01197184,-0.0818438,0.06991152,-0.04304457,0.053604845,0.10330586,0.09752303,-0.025454653,-0.053286597,0.054190326,0.023104383,-0.14347182,-0.03082421,-0.14623135,0.101337776,0.118349455,-0.026021313,0.10272015,-0.12500982,0.1001667,0.046666965,-0.04290935,-0.033629607,-0.1643804,0.02090511,0.06428262,-0.003451229,0.014937185,-0.024751658,0.06724536,-0.004701153,-0.03005591,-0.03692006,-0.081429414,0.071547024,-0.0009100886,-0.06758376,0.015279359,-0.069652654,0.07977649,0.013926955,0.056287084,0.06962643,0.07771274,0.059373192,0.042257402,-0.012184571,0.06269044,0.058295988,0.14669804,0.05990322,0.15172622,0.102293074,0.115055606,0.09751061,0.09567594,-0.041393127,0.0876523,0.049207423,0.19541472,0.053577106,0.20925161,0.1078104,0.04380132,0.07226353,0.07752808,-0.004699174,0.04262675,-0.11981387,0.11053531,0.038933404,0.12619624,0.10658389,0.023660332,0.0043104407,0.011365009,0.07314102,0.06578542,-0.22869232,0.051162932,-0.017202748,0.03378704,0.05633102,-0.017942583,0.004257176,0.07801127,0.010051726,0.12090509,-0.18012257,-0.051414277,0.047564343,-0.07582631,-0.021890817,-0.105859056,-0.07835038,-0.037545957,-0.043274254,0.26687253,-0.14571102,-0.050603766,0.07879897,-0.18958542,-0.033695165,-0.0340111,-0.037086956,-0.07838168,-0.0054239877,0.19479427,-0.10046744,-0.08122793,0.0065134214,-0.084615216,0.013599152,-0.07925037,-0.011284506,0.0399028,0.013690918,-0.013925078,-0.07799646,0.10104036,-0.032314662,-0.10131849,0.01942043,-0.05508741,0.074374475,-0.04711018,0.011945737,-0.054191995,-0.023280913,0.035718933,0.071141936,0.020845953,-0.029994687,-0.016643198,-0.0425657,-0.056159317,-0.049079668,0.026571026,0.04700238,0.08884846,0.08315128,0.04376767,-0.089264914,-0.11167818,-0.09617677,-0.1497732,-0.030664535,0.0013773696,0.0012950033,0.02534519,0.04435318,0.03438627,0.026914371,-0.022916261,-0.045984376,-0.1360791,-0.012711455,0.090091944,0.044201005,0.07187783,0.06383189,0.08142837,-0.0066159177,0.15161236,-0.09602567,0.0127125615,-0.066684134,0.0511084,0.019882824,0.08416447,0.003589187,0.08189238,0.01858363,0.15182872,0.023172187,0.1592684,0.02697124,-0.027390677,0.010248735,0.21103278,-0.010202671,0.022617374,0.018778048,0.01849534,-0.00076358084,0.09024253,0.059091493,-0.14910299,-0.24061078,0.18271491,-0.047200363,0.04489576,0.031965308,-0.10538175,0.00020872551,0.0039187525,0.0397445,-0.12736516,-0.22647782,0.15332104,0.00459901,0.07150792,0.013652282,-0.15509135,0.009589583,0.020179888,-0.043197345,-0.088800594,-0.122887544,-0.0017203001,0.06158579,-0.043253973,0.08343744,-0.16411068,-0.119920865,-0.0328889,-0.03451848,0.17774817,-0.14026135,-0.055523824,0.09182017,-0.10568331,0.026063923,0.03661197,-0.039536886,0.02640902,0.08053741,0.22227311,-0.09097702,-0.061218616,0.07877254,0.039829373,-0.046006326,-0.024475204,-0.09778343,0.028759751,0.027204102,0.029225506,-0.026954642,0.17558782,0.04245832,0.028579408,0.09644226,0.0020861423,-0.16100602,-0.15243402,-0.06967882,-0.08154721,0.001440489,0.04218239,0.035728388,0.068404905,-0.026144264,-0.036375612,-0.21558632,-0.20638844,-0.009697764,-0.010667794,0.023943331,0.048758365,-0.0013472289,0.07395488,0.0044529196,-0.17120509,-0.30582684,-0.1359557,0.016980678,0.026092356,0.03325818,-0.008937167,-0.040417347,0.006470694,0.043557152,-0.14276592,-0.34364462,-0.044273168,0.034150742,0.050539643,-0.01099729,-0.11141897,0.04943759,-0.008540585,0.025180101,0.1970544,-0.12362435,0.13054322,0.009019103,0.091565706,0.016692523,-0.058798578,0.11295862,-0.031549297,-0.2519972,0.13653046,0.009356556,0.08171034,0.04365086,-0.0136714475,-0.13276489,0.089061685,0.035965275,0.06052898,-0.13886788,-0.06583508,-0.06026764,0.036207013,0.03243683,-0.1444229,-0.13489845,0.08868686,-0.019870546,0.062082354,-0.017430356,-0.16972105,-0.03904325,-0.03485814,-0.004669837,-0.20637742,-0.0017974669,0.07480556,0.015047459,0.13940448,0.03485413,-0.17052422,-0.029428478,-0.03281059,-0.045728542,-0.30976754,0.0891512,0.0013878451,0.059235264,0.030778999,0.13051063,-0.080737926,-0.15681762,-0.028622223,0.06059619,-0.08625062,0.07621852,-0.07484231,0.11384127,-0.097975515,0.038562693,0.05286298,-0.09862306,-0.00896725,-0.046361145,0.040735077,-0.020906188,-0.04118395,-0.04115115,-0.013199347,-0.06505258,-0.015372546,-0.0971094,-0.036675934,0.012511992,-0.074777484,-0.096137345,0.055311017,-0.033465352,-0.023083745,0.039794113,0.06924369,-0.14229661,-0.17655542,0.11211834,-0.12412946,-0.032543864,-0.12940714,-0.07627373,0.029459966,-0.015136688,-0.08228502,-0.13145679,-0.15467855,0.0469086,-0.11811705,0.016556146,-0.06049217,-0.2424774,-0.02830829,0.077208266,-0.32257485,-0.06753026,-0.017792733,0.079329,0.011481412,0.06417009,-0.2400814,-0.11222648,0.030858207,0.090443164,-0.079786755,-0.046775185,0.11986619,0.062492624,0.11847584,0.06725324,-0.35646713,0.022459952,0.005304434,-0.1956191,0.18437508,0.03028529,0.13763891,-0.008629145,0.06605152,0.10011954,-0.1327911,0.10955009,0.042062253,-0.3968025,0.06276289,-0.01742074,0.029826766,-0.012979996,-0.034394402,0.019726893,0.006673064,0.016792567,0.079685956,-0.11282209,-0.22767353,-0.06692242,-0.017303659,0.104017235,-0.048666585,-0.017230326,-0.0021296842,-0.058237825,0.07073134,0.022288358,-0.1754019,-0.06962042,-0.04633874,0.10182679,0.0039567556,0.047592368,0.018032024,-0.13285357,0.07008987,0.008508693,-0.12574367,-0.070131265,0.013614406,0.067001715,-0.101280145,0.13866386,0.044618867,-0.09509975,-0.15250386,0.11040524,0.0029683327,-0.14173837,0.021098323,0.02894429,-0.14315768,0.07520275,0.015930826,-0.02621725,-0.08032271,0.032701347,-0.05724309,-0.07573539,-0.05906503,-0.039853815,-0.010021828,0.0929758,-0.0007805164,0.02021295,-0.06294563,0.0045493795,-0.08229344,0.0006968121,-0.011069092,-0.02934816,0.03313483,-0.080034755,-0.07002824,0.03748817,-0.048048865,0.008494153,-0.09342757,-0.073964834,-0.039121233,0.1019871,-0.09110434,-0.09545532,-0.070436835,-0.1268784,-0.075581156,-0.002278197,-0.17326438,-0.022690488,-0.11393671,0.053674452,-0.1698338,-0.023379648,-0.10419902,-0.26649156,-0.12000787,0.034419313,-0.2635619,0.0070889066,-0.11069528,0.015830517,-0.06891268,0.090447664,-0.15107153,-0.042691648,-0.005314959,-0.06756718,0.049053952,0.055819567,-0.015874049,0.047647573,-0.025714891,0.065796785,-0.16432059,0.03898033,-0.00045806877,-0.36548004,0.1832652,0.09954611,-0.01823165,0.09018853,-0.060476467,0.092134744,-0.0038234773,0.055089463,0.012149132,-0.24480526,0.014100368,-0.07248103,-0.09798524,-0.0056252615,-0.0885947,-0.018557979,0.0063565066,-0.02809825,0.009222301,-0.049396336,-0.40271252,-0.082855836,0.019289868,0.09140678,-0.0670494,-0.075332545,0.024173312,-0.1105485,0.03562235,0.052323215,-0.19072762,0.032155626,0.0062829857,0.01943173,0.04549415,0.058475263,0.048487443,-0.18705027,-0.22796936,0.07261883,-0.0436815,-0.051864777,-0.0057343408,-0.0366977,0.07153097,0.062982835,-0.05531175,-0.077429324,-0.16164382,0.07997895,-0.0003835664,0.057946943,0.098211065,0.073525414,-0.036944073,-0.022629492,-0.09984763,-0.0098404195,-0.0031021112,0.053287048,-0.025343316,0.15102454,0.0064770505,-0.056402948,0.037874546,0.05138941,0.0052009653,-0.03109883,0.058241956,0.05230286,-0.03035382,0.13346156,0.14558776,-0.021421121,-0.038808595,-0.050428543,-0.0050995243,-0.11243616,0.06975866,0.08481828,-0.04123495,0.15302972,0.05013301,-0.07457092,0.11457076,-0.045225874,-0.11729893,-0.117852405,-0.13355964,0.14982979,-0.22177906,0.044161685,-0.088924706,0.059672434,0.049447946,0.055576686,-0.062213354,0.027601704,-0.12565614,0.15274985,-0.0100197885,0.04944988,-0.18313178,-0.04362532,-0.052868962,0.18342564,-0.011843452,0.15725325,0.017810604,-0.054672446,0.10933587,0.13800307,-0.21583663,-0.020656565,-0.14998423,0.144183,0.022057815,0.10889982,0.010950655,-0.15593818,0.17739703,0.12325312,-0.24683812,0.054518104,-0.11961342,0.06407856,0.07301935,-0.033069313,-0.005404672,-0.058581635,-0.053599346,0.008337039,-0.07471356,0.08742706,-0.02638812,-0.010304959,0.018892184,-0.04559192,0.01567829,-0.0062222835,-0.1976974,0.037145328,-0.005554697,0.0957032,0.032133885,-0.06677905,-0.023109935,-0.05505931,-0.0052897152,0.010015692,-0.052858055,0.107590415,0.004930681,-0.04047057,0.033787888,0.029936569,0.0013916508,-0.04003461,-0.18392496,0.029858455,-0.0060566613,0.13226087,0.03052838,-0.027336264,0.08451799,0.0069376524,-0.14021787,-0.0044801785,-0.082438596,0.018065957,0.03551223,0.1898809,0.093310356,-0.0017478062,0.0136313485,0.02027241,-0.17837904,0.022704855,-0.09270591,0.04206018,0.067161195,0.1889232,-0.017173836,0.05713749,0.013873166,-0.11081736,-0.013541525,-0.065628886,-0.061364777,-0.01834738,0.016823472,0.10605626,0.17071226,-0.043278225,-0.018518645,-0.066455774,-0.06583893,-0.0723094,-0.047193486,0.0780361,-0.08814814,0.15215908,0.18067934,-0.0141249485,0.14442721,-0.15019993,-0.092820264,0.009625522,-0.01283808,0.14333977,-0.02965048,0.10955567,0.06418217,0.028605057,0.19671327,0.06049889,-0.05365713,0.102544636,-0.1158313,0.16317867,0.08631529,0.081988364,-0.05596852,-0.02687745,0.14624675,0.20712566,-0.041013964,0.14174458,-0.085550204,0.0817783,0.10578995,0.13843744,-0.07045282,-0.023220865,0.017530793,0.17336176,0.061241478,0.03444262,-0.06563621,-0.02203289,0.10125914,0.061858177,-0.056452144,-0.015177314,0.016219359,0.040997982,-0.026760926,-0.06578835,-0.05315898,-0.012950609,-0.033041578,0.033785,0.022729248,-0.012034941,0.033554982,-0.0061857337,-0.04513546,-0.09192497,-0.060957342,0.025640553,-0.058282796,0.056942854,0.09600095,-0.012013628,0.066378064,0.033307746,-0.15055312,-0.01875579,-0.038195003,-0.021801263,0.015329043,0.044096854,0.04974119,-0.020443015,0.034216624,0.050500154,-0.06971794,-0.023369903,-0.098860875,-0.05500518,-0.09033389,0.10202779,0.060454812,0.06502185,0.07002016,0.038173582,-0.14045767,0.014534159,0.006374187,-0.005688357,-0.05355902,0.18561615,0.058235247,-0.032625515,-0.054029938,-0.042824488,-0.12783763,0.015559688,-0.08004561,-0.024851678,0.06181293,0.031547405,0.0018446663,-0.07360288,-0.0058575366,-0.056698132,0.0099227475,0.06154194,-0.043833945,0.0053015742,-0.024797851,0.14200646,0.23174249,0.07150613,-0.052749682,0.022039797,0.021481486,-0.019093795,0.045445085,0.15029903,0.029958215,0.14417166,0.17164408,-0.056584246,0.04806482,-0.18354006,-0.03008795,0.06156495,-0.084010825,0.08276156,0.13299888,0.047700472,0.06637772,0.017389722,0.049944054,-0.023882573,-0.0073757065,0.087500975,0.000828718,0.12372805,0.109657824,0.083081335,0.07741296,-0.037513603,0.06597714,0.083218925,0.049804516,0.09808834,-0.047665946,0.10462099,0.032271553,0.10178728,0.046066836,-0.040117983,0.12027135,0.06635425,0.036601644,0.014257216,-0.015895966,0.04411955,-0.017087659,-0.033293407,0.066063754,0.02497412,0.044499233,0.009098633,-0.044712134,0.03142498,-0.047417697,-0.011621297,0.03919155,-0.039953463,0.0628625,-0.034025334,0.033192463,-0.05425785,-0.07904185,0.012214516,-0.07078432,0.020028008,0.0032201533,-0.021567456,0.07953937,-0.0075595323,0.065289415,-0.016172562,-0.067001484,-0.009714517,-0.031563904,-0.07058159,-0.07103084,0.00032690083,0.03920194,-0.018604616,0.013361384,-0.013739295,-0.112878144,0.05672514,0.0014324306,0.03462107,-0.117067516,-0.0247361,-0.042720687,0.024605626,0.0009932284,-0.003488219,-0.14713132,-0.0394939,0.026461229,0.09203205,-0.09369431,0.069089204,-0.06321062,-0.059806,0.06568726,0.017928451,-0.032255672,0.03944027,0.043803718,0.0045726276,-0.017342376,0.01873647,-0.053275313,0.053500697,-0.042424437,0.011250308,0.071129546,-0.0018040842,-0.026634892,0.07057755,0.027435292,0.0043271696,0.12249861,-0.055868037,0.0064965673,-0.01846214,0.0067883045,-0.10482724,0.027209777,0.06887368,0.05341442,0.028285757,0.2059619,-0.06704849,-0.06426034,-0.06999615,0.09700829,-0.11856088,-0.012491517,0.013300801,0.08797409,0.00525146,0.13699996,-0.076234385,0.0031047713,-0.14598957,0.11111164,-0.00055952976,0.057533342,0.043874502,-0.06550114,-0.028974995,0.089235604,0.03317452,0.01899735,-0.103196956,0.07556694,0.045148432,0.019838728,0.09410673,-0.11193057,-0.049868487,0.068114355,-0.048847,0.046257306,-0.24358778,0.09342761,0.13396147,0.0043527894,0.10843881,-0.025942666,-0.14119959,0.018587,0.020494854,0.0517714,-0.26475698,0.09589105,0.14276405,0.00990621,0.036514614,0.08710667,-0.0640734,0.02305475,-0.011234153,0.07385748,-0.13493904,0.098944426,0.11156986,-0.03070791,-0.04973486,0.048952628,-0.05449928,-0.11560287,-0.0047137584,0.051615477,-0.08780979,-0.031061484,0.11709873,-0.016922897,0.06487655,-0.014223633,0.015051715,-0.006911309,0.052619174,-0.07916442,-0.07293861,-0.16885693,0.054875,0.10475301,-0.028718006,-0.088032626,0.056032293,0.038386535,0.07355117,0.024708252,0.029598277,-0.011214116,-0.1045624,0.08808116,-0.041374475,-0.058136698,0.06426753,0.023165496,0.03294743,0.004636585,0.033323627,0.0068855123,-0.024648145,0.09920049,-0.076528996,0.010366258,-0.03287183,-0.00043293947,0.018758554,0.07523673,0.06823,-0.06848234,-0.009093779,-0.008158953,-0.08685406,-0.07350549,0.026050733,0.1117613,-0.0012485362,0.041583728,0.0027635305,0.06228276,-0.10440825,0.057844687,-0.003562148,0.009876343,-0.058683835,0.085433245,-0.07234652,-0.07331589,-0.0131016215,0.034503184,-0.12647343,0.10143114,-0.09164599,-0.06347921,-0.04975801,0.13921428,-0.025407825,-0.048989348,-0.11384183,0.1969979,-0.07744128,0.04024884,0.0026870756,-0.027194006,-0.10407329,0.086489595,0.008478123,-0.053165257,0.0067967474,0.17205715,0.0027671237,0.09373043,-0.050212134,-0.11965871,-0.05836565,0.103856705,0.018671267,-0.059454065,-0.09115055,0.22424808,-0.08020175,0.15802176,-0.005194189,-0.11107901,-0.019299753,0.094271235,0.015022028,0.00800496,-0.10290653,0.1926984,-0.001922662,0.146286,-0.073135205,0.047790963,0.037756965,-0.0014719462,0.018905988,-0.028091757,-0.036903363,0.17668182,0.09089604,0.1774536,-0.06884189,0.029958006,-0.064862214,-0.06959225,-0.049137115,0.03748292,0.035133097,0.007267598,0.021310244,0.13750185,0.06546149,0.05290484,0.015135777,0.058580533,0.07471622,-0.04470292,-0.028321395,-0.038671907,0.008060771,0.07881504,-0.034834884,-0.042974435,0.031324312,0.054080814,-0.02252532,-0.08051705,0.035091788,0.0437603,0.00899731,0.084656,0.06278844,0.040659443,0.02156695,-0.0015896311,-0.07598409,0.014143541,-0.047694094,-0.002814497,0.03750069,-0.037430603,0.07756753,-0.07192865,0.022002347,-0.008684126,-0.047002964,0.028555365,0.034197383,0.022074752,-0.071206555,-0.08284362};
    wt_t fc_params_linear[1440] = { -0.079887666,0.037666745,-0.0646291,0.047336746,0.03578022,0.06894379,-0.0472288,0.05440499,0.038119763,-0.032299273,-0.022049926,-0.03805529,-0.050355196,0.010031178,-0.020587714,-0.07619561,-0.046548553,-0.03449374,-0.0808194,-0.06223328,-0.034093734,-0.073432885,0.11752969,0.03245147,-0.028118867,-0.022356045,-0.03058101,-0.049455393,-0.07542431,-0.0500957,0.014127678,0.05404829,-0.011861383,0.016889187,0.027145976,-0.029775344,-0.033707034,0.032428864,0.03946386,0.018680539,0.057818286,0.03424405,0.006733727,-0.018292457,-0.0504974,0.017603137,-0.016543087,-0.06486203,-0.014263901,0.00832637,0.0555361,-0.053385425,0.052097365,-0.068347774,-0.07183572,-0.034721006,0.074058704,-0.09424744,-0.059633873,-0.16036846,0.023080794,0.08541336,0.03828963,-0.084177956,-0.083432324,-0.054616723,-0.06185484,-0.028995313,-0.022058094,-0.15541133,0.06394386,0.017082464,-0.06428436,0.038962696,-0.081436045,-0.06267719,0.028029868,-0.024947647,0.009635548,-0.19646554,-0.05983812,0.0140906405,0.072358616,-0.034872495,-0.05512758,-0.15055613,-0.013743489,-0.14568806,-0.04843695,-0.16648911,-0.0204601,0.083989665,0.105179265,0.028440041,0.05288769,0.04493029,-0.026145276,-0.10627483,0.060200118,-0.09850978,0.07517256,0.11080112,0.012928911,0.0063918624,0.023782738,0.02945306,0.03944944,0.015303048,0.048174333,-0.10257085,-0.000842635,0.09815575,0.04827775,0.05306266,-0.016987246,0.046964135,-0.009496433,0.028852483,0.07017076,0.030538017,0.063238665,-0.002392202,0.0038618932,0.023895998,0.063350886,0.016305028,0.00735882,0.05302776,-0.07737518,-0.061772436,-0.045791533,-0.09826466,0.08516127,0.023986403,-0.0016945448,-0.029038815,0.08128474,-0.09503643,-0.043409828,-0.053770877,-0.05997995,-0.07909357,0.028013917,0.10654001,-0.011138834,-0.022801302,0.02853394,-0.0069120596,-0.07550506,-0.106420964,0.046992626,-0.056019317,-0.043692686,0.07412649,0.0038646145,-0.034596317,0.07566796,-0.12434672,-0.10537556,-0.09021075,0.05773515,-0.073683254,0.052986193,0.10168672,-0.0073537915,-0.009774467,0.00087260094,-0.0031171544,0.032173127,-0.024325998,0.014050325,-0.0128254425,-0.020343358,0.04835014,-0.017729618,-0.026107265,0.031079236,-0.02154474,-0.053486392,-0.020142406,-0.00975361,-0.049802326,-0.017370645,-0.06303838,-0.07472216,-0.031215932,-0.01769335,-0.011455514,0.027590875,-0.0124798175,-0.0066853347,-0.13376296,-0.06405354,0.0757357,-0.035805304,-0.08689514,-0.076397024,-0.110696256,0.12923843,0.018525917,-0.059826702,0.06199684,0.06494714,0.0024643217,-0.08141795,-0.09399826,-0.0701123,-0.1535816,0.054440767,-0.0020860848,-0.025275506,0.08041915,0.04745192,0.06021455,0.15414909,0.051688183,-0.0306412,-0.14952557,-0.019856274,-0.18739325,0.006891725,0.054803796,-0.004171691,-0.048638895,0.17874205,-0.00617523,-0.052400615,-0.10248197,0.11533006,-0.06216742,-0.05683517,-0.03970702,-0.11760508,-0.02859206,0.05694435,0.07762523,-0.0038573765,0.02280634,0.033968788,0.009940722,0.07906698,0.07641899,-0.0020251388,0.07806481,0.07659829,-0.043848287,0.039417706,-0.071683995,0.051531233,-0.03030053,-0.07447973,-0.010433463,0.15604569,0.12353085,-0.0026487538,-0.005894923,-0.024050323,0.004130906,-0.047790766,-0.06655264,0.009076979,-0.032933697,0.02701328,0.1288413,0.024338424,0.061819803,0.020660315,-0.031124583,0.04435476,-0.16658404,-0.060630407,-0.16406006,0.110465996,0.17134391,-0.00064521516,0.11143004,0.048514526,0.02833002,-0.04132957,-0.16171491,-0.05833171,0.0190911,0.14992978,0.08720901,0.05322054,0.023085661,-0.009462833,0.044809982,0.03843181,-0.010609611,-0.027893508,-0.09825397,0.082688324,0.038771916,-0.20513065,0.008810894,-0.047481995,0.059586454,0.017327374,0.08035371,-0.010266783,-0.030510152,0.014137481,-0.08496591,-0.21347658,-0.015967939,0.00831062,0.08037623,-0.07601287,0.2592944,-0.054580893,-0.094847284,-0.019808698,0.0023110984,-0.16173023,0.014374509,-0.044797536,0.08374099,-0.10607054,0.12854266,-0.0694641,0.009732022,0.028289555,-0.11263024,-0.0014452372,0.13804695,-0.02338199,-0.055371907,-0.10798684,0.14416179,0.068177275,0.0144328335,0.05368283,-0.024464183,0.03727503,0.16175604,-0.04475592,-0.110989064,0.0024214203,0.0005149151,-0.022878716,0.026408046,-0.058149714,0.09397328,0.12090394,0.23281509,-0.04612814,-0.07566076,0.09666519,-0.10514264,0.05451749,-0.032290105,-0.07402369,0.053416256,-0.021620458,0.22241692,-0.014872633,0.05276098,0.09816669,-0.1480882,-0.02297997,-0.013579589,-0.051128734,0.12192462,-0.022969566,-0.04041712,-0.012002533,0.16192703,0.041605517,0.021160394,-0.010482889,-0.071994185,0.06535822,0.06743151,0.019768609,-0.013088936,-0.030109655,0.013571448,0.057534155,-0.07904666,0.0044017993,-0.0822389,0.058754295,0.0047370708,0.049001474,0.07333562,-0.05718729,0.06868298,0.085821755,0.08972734,0.04063638,-0.052107006,-0.105789155,-0.10861587,-0.051368896,0.11146789,0.025602788,0.050090674,0.02652861,0.05660407,-0.028260289,-0.012884511,-0.026801864,-0.24674353,-0.07861208,0.035057414,-0.08970746,0.060692795,0.12061198,0.040095683,-0.0015441491,0.04471888,-0.1720192,-0.17180288,-0.102485,0.071334735,-0.059744224,0.046460494,-0.07660227,-0.05616403,0.038136937,0.17966774,-0.027491862,0.083426856,-0.1368024,-0.12367878,-0.08501015,0.23854285,-0.18027148,0.008537197,-0.040733404,0.09600833,0.118477546,0.24870825,0.0017066788,-0.12369649,0.051893696,0.2985841,-0.008812554,0.036706913,0.005067796,-0.012603636,0.09946162,0.15765163,0.01966971,-0.12216234,-0.07942112,0.25425673,0.0828031,0.12544477,-0.0781434,-0.04765213,-0.04874886,0.110530235,0.03489587,-0.031077206,0.03909433,0.121343166,0.06444904,0.13315453,0.028227733,-0.044551063,-0.0021461486,0.06978063,0.0049760044,0.123057745,-0.05888248,0.03314765,0.084501356,-0.049127806,-0.058046553,-0.0974011,-0.0056415075,-0.05570529,-0.056172792,0.15106237,-0.036402997,-0.017999372,0.016542384,-0.10858411,-0.076250084,-0.06809935,0.06534953,-0.028005557,-0.047885098,-0.017792456,0.018870946,0.104557075,0.05917441,-0.09090701,0.013688768,-0.057531107,-0.04476905,-0.08100646,-0.029986009,-0.0019500322,0.019203972,-0.006181807,0.08520885,0.09805902,0.012358956,0.095033616,-0.17301312,-0.13673055,0.050069153,0.027886579,-0.009247558,0.03871983,0.00783373,0.04480573,0.056880534,-0.07746519,-0.22348289,-0.24477953,0.068603225,-0.034522053,0.05554029,0.09045074,0.026945354,0.08176064,-0.022150617,-0.18444258,-0.3735804,-0.16555844,0.13820364,0.1465694,0.0627569,-0.07558421,0.03181162,0.021176873,-0.058988344,0.03264973,-0.35854957,-0.0777343,0.05360512,0.20225823,-0.016513184,-0.0996958,0.12443946,-0.03547905,-0.008872263,0.34355897,-0.101334386,0.16841555,-0.078029975,-0.11261233,0.03865607,0.23109224,0.07690634,-0.041151576,-0.032281928,-0.0070545967,0.019507678,0.14164759,0.06415887,0.009253622,0.0021715097,0.22014254,0.09630824,0.11674961,-0.074934125,-0.12061848,0.07454731,0.04578402,-0.14610781,-0.13021274,0.04215811,0.29418704,0.06435008,0.16815369,-0.0013384402,-0.14984788,0.021065658,0.051015265,-0.049124494,-0.21689248,-0.037611093,-0.0078874165,0.017752985,0.06529055,-0.028525127,-0.017541435,-0.08748927,-0.07387346,-0.09160406,-0.17046697,-0.07980459,0.05427077,0.09931478,0.046444148,0.025191553,0.059471678,-0.18108217,0.038044017,0.011718898,-0.111166775,0.03918131,0.049923476,0.06337775,-0.057331614,-0.003666015,0.03025161,-0.11877471,-0.06624565,-0.07299991,-0.010307068,0.032967452,-0.0027301002,-0.07136878,0.08531501,0.0680043,0.0074656,-0.22047035,-0.10873968,0.06958908,0.0077091167,0.058952868,-0.053528145,-0.08625636,0.07208009,-0.07990762,0.019172879,-0.14463855,-0.16954626,0.057834007,-0.074908786,-0.084488615,-0.08229843,-0.02374769,0.12985817,-0.012353139,-0.0673761,-0.19183296,-0.0033552693,0.18784966,0.04696769,-0.07831931,-0.0703885,-0.15163988,-0.0018809824,-0.03641926,-0.22116436,-0.12622887,0.17006008,0.16959229,0.2243359,0.048572928,-0.22114696,-0.07479618,0.031879786,-0.04336706,0.15960905,-0.017160742,0.22884412,-0.0048404317,0.25367615,0.03609462,-0.3154064,0.18839844,-0.015801698,-0.047457844,0.2884709,0.059956897,0.2501491,0.0071220393,0.06390932,0.06224284,-0.08497698,0.20637219,0.16069946,0.0566301,-0.060088567,-0.07743632,0.051737856,0.21375024,0.030124571,-0.04455339,0.039367262,0.08775982,0.22622988,-0.01354085,-0.1912379,-0.09104375,0.07513127,0.11985603,-0.03374679,-0.024382982,0.042354237,-0.09263161,0.1073223,0.058082376,-0.053233158,-0.0881252,-0.06962978,0.019990217,-0.20040788,-0.05722356,0.06628493,-0.09321092,-0.043963682,-0.038776804,-0.029339986,-0.30295607,0.016186332,-0.039241374,-0.21315268,0.069324374,-0.030576913,-0.105697416,0.032366946,0.032456506,0.059612337,-0.15911153,0.041053258,-0.04568132,-0.110049106,-0.04894812,-0.056819163,-0.006202626,-0.024479002,0.05957381,-0.038444526,0.009446414,0.034908712,0.072976016,-0.017756628,0.061711412,-0.054495063,0.034091458,0.035127435,-0.06918949,-0.047147773,-0.038518306,-0.051318996,0.04102696,-0.036793135,-0.05548355,-0.03369148,6.866587e-05,0.050623845,-0.057235975,-0.123242065,0.0032979639,-0.13113767,0.12449756,-0.12243948,0.070878685,0.0759216,-0.16073847,-0.1029387,0.03329265,-0.19088136,-0.043127898,-0.13715412,0.123599015,-0.19578551,-0.048736487,-0.023113476,-0.1646808,-0.020932183,0.051157784,-0.16244747,0.02540904,0.0076358537,0.08777378,-0.015924003,-0.046971753,-0.23893599,-0.043381687,0.15343064,0.03504821,0.17753886,0.09206491,0.003787563,0.13034208,0.009060536,0.07322727,-0.054233477,0.14779676,-0.020491654,-0.094762735,0.22607473,0.052637085,0.04452613,0.20909245,-0.02142381,-0.04094088,0.031589106,0.04446906,0.00080860814,0.0025658575,-0.22463447,-0.026567219,0.09699113,0.26127088,0.0023001463,0.052403703,0.07482042,0.014609004,0.21393554,0.019444605,-0.2416391,-0.085162915,0.07446809,0.1223709,0.05948794,0.036030658,0.07497244,-0.1426092,0.0035558953,-0.07556208,-0.039259773,-0.06481907,0.016597299,-0.038711328,-0.044113096,-0.076817416,-0.004725312,-0.19260229,-0.1849991,-0.07558086,0.0013918141,-0.078977294,-0.11362109,0.02996986,-0.045587588,-0.060624048,-0.10842319,-0.014321502,-0.11508742,-0.043321654,0.010508898,-0.1036221,-0.042613488,0.02248929,-0.09936222,-0.016416784,-0.06878889,0.031515446,-0.09137295,0.080518365,0.024610374,0.06571019,0.0072103236,-0.055675223,-0.028518165,0.07188592,0.06067087,-0.08245288,0.061061148,0.015931249,0.012408856,0.14840811,0.028642775,-0.08445176,-0.049373083,-0.03799972,-0.07005756,-0.12862554,-0.044944946,-0.016659433,-0.17173308,-0.02387083,-0.06263318,0.08264843,0.007000569,0.022969056,-0.02551409,-0.07866245,-0.13960807,0.01054758,-0.16029072,-0.028400254,-0.20194972,-0.08086904,-0.20726964,-0.051145718,-0.03574376,0.0037979512,-0.10537444,0.03559048,-0.079647206,0.19520943,-0.17413576,-0.10696721,-0.25540176,0.04922952,-0.062235318,0.17011692,-0.037879184,0.059776444,0.25421387,0.20654584,-0.15645029,-0.0139688775,-0.24535178,0.025276406,0.014231343,0.024505993,-0.05119107,-0.012917187,0.093793996,0.07464193,-0.18826129,0.089015864,-0.0040732394,-0.040938374,0.114519596,-0.025075098,0.032687325,0.0041343626,-0.2823088,0.057059076,-0.031724967,0.15492927,0.03392378,0.027441716,0.031677943,0.08563114,-0.015701389,0.023906609,-0.16038671,0.04055861,0.012986725,-0.10951822,-0.024951331,-0.08397981,0.05924994,-0.029987652,-0.17701676,-0.02829776,0.049345244,0.07991916,-0.10565658,-0.16640674,0.072376564,-0.08445458,-0.1132786,-0.12039367,-0.21353787,0.05986323,0.034944117,0.16658922,0.047099676,-0.12092456,-0.03753859,-0.049218033,-0.14131162,-0.094589554,-0.06817064,0.07288937,-0.058625773,0.111739375,0.02167466,-0.0019794842,0.07158779,-0.007092197,-0.1358376,-0.117415704,0.0027555714,-0.0029952284,-0.06774378,0.09910185,0.1255572,-0.08812401,-0.015961051,-0.0009935529,-0.10152324,-0.057611845,0.034527846,0.048587937,-0.06092456,0.2379803,0.09430313,-0.095982336,0.010819379,-0.0031074733,-0.15829684,-0.06891486,0.021291783,0.022574,-0.14015934,0.13017333,-0.018463809,-0.1036062,0.24275918,-0.060665548,-0.04135151,0.05322917,-0.16799301,0.019298794,0.031340312,-0.11460832,-0.17453146,-0.2225408,0.1588968,0.06384715,-0.13994902,0.08706202,-0.08210898,0.04612858,0.090239495,0.07199911,-0.19592892,-0.25583115,-0.048054155,-0.05385317,-0.119571455,-0.020100148,-0.117338836,-0.025834154,0.21097909,0.03797025,-0.18391931,-0.019324657,0.047126416,-0.05528925,-0.028300282,-0.24563912,-0.14983422,-0.020683626,-0.022646395,0.031423684,-0.013115908,-0.04987765,0.029718937,-0.009750059,-0.06644935,-0.13804048,0.04036346,-0.031795327,-0.06069576,0.07567965,0.13237661,-0.20278291,0.06548301,0.035730716,-0.14917731,-0.06926238,-0.07101394,0.00016492783,0.0633635,0.07611379,0.06938301,-0.17536424,-0.11124588,-0.08348944,-0.05665641,-0.052501187,-0.13506733,0.053252686,-0.033013403,0.062495194,-0.08095469,-0.12850228,0.0645799,0.06598224,-0.1446575,0.015905648,-0.12382953,0.0552752,-0.009283337,0.03744689,0.04496888,-0.015318331,-0.012154438,0.0066542337,-0.10539783,0.0103108175,-0.030580126,0.07495874,-0.06850146,0.044891912,0.032840453,-0.035187975,0.024519322,0.04663307,-0.04258834,-0.061270237,-0.043014154,0.043306626,0.065182716,0.03452939,0.1256333,-0.087258615,-0.025835626,0.019856626,0.021211669,-0.036864668,0.057024628,-0.03003217,0.07518128,0.12861225,0.13045795,-0.086071566,-0.061240107,-0.029149033,-0.025633164,-0.055515774,0.007814358,0.0092385765,0.06025929,0.017499454,-0.0931094,-0.11612549,-0.055644285,-0.0096646575,-0.058712933,0.07409669,-0.099002875,-0.027453803,0.10505567,0.04577224,-0.11776409,-0.13236035,0.16783741,-0.053024255,-0.07508635,0.10379089,-0.23824535,-0.058055464,-0.08507943,0.083534576,-0.13420452,-0.2009124,0.15356824,-0.04843191,-0.03287658,-0.10223315,-0.2667291,-0.06466905,-0.055719554,-0.0019138692,-0.1087492,-0.029073011,-0.040787973,-0.055176977,-0.09666434,-0.061050415,-0.15161715,-0.06437335,-0.05924421,-0.040085394,0.098326065,-0.04825287,-0.097383074,-0.037008744,-0.20414877,0.019072717,-0.13422984,0.014285899,0.08707516,0.039849576,0.09650247,-0.012031479,0.008635184,0.0014594747,-0.22362952,-0.09871339,-0.07880571,0.020016199,-0.021459196,-0.0015885535,0.050739143,0.013071072,-0.019761397,0.04781009,-0.13393916,0.006286551,-0.14593388,-0.04830468,-0.122688234,-0.008001172,-0.012763701,0.037179563,-0.011699774,-0.0032668083,-0.15225081,0.033862785,0.00029600374,-0.026910726,-0.0050624134,0.025609946,-0.046905436,-0.0060712663,-0.07755024,-0.020276058,-0.15130484,-0.03802845,0.11433284,-0.06606641,-0.01961366,0.024668604,0.040370025,0.013283454,-0.007903126,-0.015264946,-0.07642732,0.06784962,0.07107789,-0.064847164,-0.006413718,0.0044654966,0.10360037,-0.08438431,0.015313502,-0.037256885,-0.042947568,0.017433671,-0.008482796,0.073189616,-0.018200034,0.03437376,0.10769649,-0.051200956,-0.07588712,0.050562803,-0.05161355,-0.060355414,-0.044719588,-0.042456686,0.10201872,-0.027702726,0.032185532,0.011554748,-0.16324303,0.030912701,0.019110516,-0.13283034,-0.08683816,0.03033885,0.114788234,-0.037620943,0.18409231,-0.0029443887,-0.0015020728,0.011670096,0.124216005,-0.0485488,-0.016033271,-0.053137567,-0.108459875,0.004077009,0.10229267,-0.023482073,0.0879419,-0.021611104,0.012689398,0.17962019,0.010492927,-0.009046137,-0.17305556,0.028653173,-0.0328663,0.022624884,0.076791875,-0.07989617,0.09884312,0.23646703,-0.015236669,0.027093325,0.015247744,0.03150765,-0.06409981,0.13123816,-0.029871501,0.06991669,0.0043799365,0.078060344,-0.10905513,-0.070709504,0.053181387,0.022148566,-0.062366568,0.09680197,0.097415805,0.04457626,-0.06471793,0.051966228,-0.05391344,0.01830226,0.05771452,0.00028946012,-0.053025685,0.054652736,0.026844803,-0.07720133,-0.04810011,0.044769224,0.0037843445,0.037437126,-0.10029815,0.01512737,-0.024383383,-0.037872586,-0.11298481,0.02330824,-0.13190205,-0.01780468,0.14167888,0.07798014,0.019530673,0.084589735,0.018422564,-0.004728585,-0.088555165,-0.008966735,-0.050331812,0.030778673,0.048909225,-0.047298264,0.07610746,0.083735645,-0.06527678,0.036475647,-0.04973029,-0.07848473,-0.0042225407,0.0002852223,0.044254106,-0.05033926,-0.0046815313,-0.08621905,-0.0050045815,0.075835206,-0.015456568,-0.0732118,0.049912747,-0.05780606,0.05157627,-0.059685018,0.038345087,-0.0790317,0.1687738,-0.07187974,0.0006072512,-0.028277792,0.020821331,-0.048557717,0.05190437,-0.071129814,0.04936932,-0.033796664,0.15052243,-0.09450589,0.038473215,-0.06269298,0.058253653,-0.04152261,0.09168408,-0.07942156,-0.12237081,-0.052951224,0.13687786,-0.033061177,-0.01648932,0.07316431,0.17731827,-0.06917632,0.015908135,-0.05497016,-0.0153428195,-0.066784345,0.06815437,-0.059693746,0.037009884,-0.020469433,0.15553099,0.010877628,0.09811834,-0.067572065,-0.13469438,-0.11326715,-0.02232058,-0.13642342,-0.021950211,-0.003530377,0.22775841,0.09587439,0.12250168,0.022343678,0.023261478,-0.062196225,-0.013435466,-0.010253776,-0.03291671,0.07583069,0.23995669,0.10727246,0.023154391,-0.046772856,0.022357233,0.030434042,0.0045083906,-0.15419774,0.11823766,-0.033305876,0.10402425,0.13106945,0.10040125,-0.04648778,-0.046219986,-0.060148727,0.039131526,-0.10806578,0.025899839,-0.013273303,0.02736304,0.0656269,0.016100159,0.01771073,0.046228897,0.10453591,-0.03278801,0.048772335,-0.11493473,-0.07685723,0.044994432,-0.04364932,0.067421235, 0.012196764,-0.00511775,-0.04473863,-0.030261254,-0.032876804,-0.02421754,-0.08229569,-0.09368214,0.0017085662,0.023892429, 0.022549188, 0.07496932, 0.03943498, -0.074551545, 0.060333807, 0.009098822, -0.047418293, 0.045776587, 0.021663452, -0.02392086};
    //Convert into 2-dimensional fc_params 
    
    for(int loop1 = 0; loop1 < IN_LINEAR_LENGTH; loop1++)
    {
        for(int loop2 = 0; loop2 < OUT_LINEAR_LENGTH; loop2++)
        {
            fc_params[loop1][loop2] = fc_params_linear[loop1 * OUT_LINEAR_LENGTH + loop2];
        }
    }

    std::cout << "Beginning Inference..." << std::endl;
    
    // Call kernel function here
    for (int i = 0; i < SET_SIZE; i++) {
        for(int loop1 = 0; loop1 < IN_FM_DEPTH; loop1++)
        {
            for(int loop2 = 0; loop2 < IN_FM_HEIGHT; loop2++)
            {
                for(int loop3 = 0; loop3 < IN_FM_WIDTH; loop3++)
                {
                    input_feature_map[loop1][loop2][loop3] = input_feature_set_linear[i][loop1 * IN_FM_HEIGHT * IN_FM_WIDTH + loop2 * IN_FM_WIDTH + loop3];
                }
            }
        }
        //std::cout << "After " << (i + 1) << " image : " << std::endl;
        //tiled_conv(input_feature_map, conv_layer_weights, fc_params, /*output_feature_map,*/ target_output_set[i], mse);
        tiled_conv(input_feature_map, conv_layer_weights, fc_params, target_output_set[i], mse, output_feature_map);
        //for(int j=0; j < IN_LINEAR_LENGTH; j++)
        //    for(int k = 0; k < OUT_LINEAR_LENGTH; k++) 
	//        std::cout << (wt_t) fc_params[j][k] << " ";
        //    std::cout << std::endl << std::endl;
    }

    //for(int i=0; i<OUT_LINEAR_LENGTH; i++)
    //	    cout<<typeid(output_feature_map[i]).name()<<"\t"<<output_feature_map[i]<<std::endl;
    //std::cout << " Inference completed! " << std::endl;

    return 0;
}
